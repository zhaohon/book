# å¿«é€Ÿå…¥é—¨ - 5åˆ†é’Ÿç†è§£é¡¹ç›®ç»“æ„

## ğŸ¯ ä¸€å¥è¯æ¦‚æ‹¬

è¿™æ˜¯ä¸€ä¸ª **IM èŠå¤©åº”ç”¨**ï¼Œé‡‡ç”¨ **Monorepo æ¶æ„**ï¼Œä¸»åº”ç”¨åœ¨ `apps/web`ï¼Œæ ¸å¿ƒåŠŸèƒ½åœ¨ `packages/tsdaodaobase`ã€‚

---

## ğŸ“ ç›®å½•ç»“æ„ï¼ˆç®€åŒ–ç‰ˆï¼‰

```
é¡¹ç›®æ ¹ç›®å½•
â”‚
â”œâ”€â”€ apps/web/              â† ğŸ¯ ä¸»åº”ç”¨ï¼ˆä»è¿™é‡Œå¼€å§‹ï¼ï¼‰
â”‚   â””â”€â”€ src/
â”‚       â”œâ”€â”€ index.tsx      â† å¯åŠ¨å…¥å£ï¼ˆæœ€é‡è¦ï¼ï¼‰
â”‚       â”œâ”€â”€ App/           â† åº”ç”¨ä¸»ç»„ä»¶
â”‚       â””â”€â”€ Pages/         â† é¡µé¢
â”‚
â”œâ”€â”€ packages/              â† ğŸ“¦ åŠŸèƒ½æ¨¡å—åŒ…
â”‚   â”œâ”€â”€ tsdaodaobase/      â† â­ æ ¸å¿ƒåŒ…ï¼ˆæœ€é‡è¦ï¼ï¼‰
â”‚   â”‚   â”œâ”€â”€ App.tsx        â† WKApp å…¨å±€å¯¹è±¡
â”‚   â”‚   â”œâ”€â”€ Components/    â† æ‰€æœ‰ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ Pages/         â† é¡µé¢
â”‚   â”‚   â””â”€â”€ Messages/      â† æ¶ˆæ¯ç±»å‹
â”‚   â”‚
â”‚   â”œâ”€â”€ tsdaodaologin/     â† ç™»å½•æ¨¡å—
â”‚   â”œâ”€â”€ tsdaodaocontacts/  â† é€šè®¯å½•æ¨¡å—
â”‚   â””â”€â”€ tsdaodaodatasource/â† æ•°æ®æºæ¨¡å—
â”‚
â””â”€â”€ package.json           â† æ ¹é…ç½®
```

---

## ğŸš€ 3æ­¥å¿«é€Ÿä¸Šæ‰‹

### ç¬¬1æ­¥ï¼šçœ‹å¯åŠ¨æµç¨‹

æ‰“å¼€ `apps/web/src/index.tsx`ï¼Œä½ ä¼šçœ‹åˆ°ï¼š

```typescript
// 1. é…ç½® API åœ°å€
WKApp.apiClient.config.apiURL = "https://api.botgate.cn/v1/"

// 2. æ³¨å†Œæ¨¡å—
WKApp.shared.registerModule(new BaseModule());      // åŸºç¡€æ¨¡å—
WKApp.shared.registerModule(new LoginModule());      // ç™»å½•æ¨¡å—
WKApp.shared.registerModule(new ContactsModule());   // é€šè®¯å½•æ¨¡å—

// 3. å¯åŠ¨åº”ç”¨
WKApp.shared.startup()
```

**è¿™å°±æ˜¯åº”ç”¨çš„å¯åŠ¨æµç¨‹ï¼**

### ç¬¬2æ­¥ï¼šçœ‹èœå•å’Œè·¯ç”±

æ‰“å¼€ `apps/web/src/App/index.tsx`ï¼Œä½ ä¼šçœ‹åˆ°ï¼š

```typescript
// æ³¨å†Œèœå•
WKApp.menus.register("chat", ...)        // ä¼šè¯èœå•
WKApp.menus.register("contacts", ...)     // é€šè®¯å½•èœå•

// æ³¨å†Œè·¯ç”±
WKApp.route.register("/", () => <ChatPage />)
WKApp.route.register("/contacts", () => <ContactsList />)
```

**è¿™å°±æ˜¯èœå•å’Œè·¯ç”±çš„æ³¨å†Œæ–¹å¼ï¼**

### ç¬¬3æ­¥ï¼šè¿è¡Œé¡¹ç›®

```bash
yarn install    # å®‰è£…ä¾èµ–
yarn dev        # å¯åŠ¨å¼€å‘æœåŠ¡å™¨
```

æ‰“å¼€æµè§ˆå™¨ï¼Œè§‚å¯Ÿåº”ç”¨è¿è¡Œï¼

---

## ğŸ”‘ æ ¸å¿ƒæ¦‚å¿µï¼ˆ5ä¸ªï¼‰

### 1. WKApp - å…¨å±€å¯¹è±¡

æ‰€æœ‰åŠŸèƒ½éƒ½é€šè¿‡ `WKApp` è®¿é—®ï¼š

```typescript
WKApp.route          // è·¯ç”±
WKApp.menus          // èœå•
WKApp.apiClient      // API è°ƒç”¨
WKApp.loginInfo      // ç™»å½•ä¿¡æ¯
```

### 2. æ¨¡å—ç³»ç»Ÿ

æ¯ä¸ªåŠŸèƒ½éƒ½æ˜¯ä¸€ä¸ªæ¨¡å—ï¼Œéœ€è¦æ³¨å†Œï¼š

```typescript
WKApp.shared.registerModule(new BaseModule())
```

### 3. è·¯ç”±ç³»ç»Ÿ

æ³¨å†Œé¡µé¢è·¯ç”±ï¼š

```typescript
WKApp.route.register("/path", () => <Component />)
```

### 4. èœå•ç³»ç»Ÿ

æ³¨å†Œåº•éƒ¨èœå•ï¼š

```typescript
WKApp.menus.register("id", (context) => {
  return new Menus("id", "/path", "åç§°", icon, selectedIcon)
})
```

### 5. ç»„ä»¶ä½ç½®

- **åŸºç¡€ç»„ä»¶**ï¼š`packages/tsdaodaobase/src/Components/`
- **é¡µé¢ç»„ä»¶**ï¼š`packages/tsdaodaobase/src/Pages/`
- **æ¶ˆæ¯ç»„ä»¶**ï¼š`packages/tsdaodaobase/src/Messages/`

---

## ğŸ“ å…³é”®æ–‡ä»¶ä½ç½®

| è¦åšä»€ä¹ˆ | æ–‡ä»¶ä½ç½® |
|---------|---------|
| ä¿®æ”¹å¯åŠ¨é…ç½® | `apps/web/src/index.tsx` |
| æ·»åŠ èœå•/è·¯ç”± | `apps/web/src/App/index.tsx` |
| ä¿®æ”¹èŠå¤©é¡µé¢ | `packages/tsdaodaobase/src/Pages/Chat/` |
| ä¿®æ”¹ä¼šè¯åˆ—è¡¨ | `packages/tsdaodaobase/src/Components/Conversation/` |
| æ·»åŠ æ¶ˆæ¯ç±»å‹ | `packages/tsdaodaobase/src/Messages/` |
| æŸ¥çœ‹æ ¸å¿ƒ API | `packages/tsdaodaobase/src/App.tsx` |

---

## ğŸ¯ ç¬¬ä¸€ä¸ªä»»åŠ¡ï¼šä¿®æ”¹æ¬¢è¿æ–‡å­—

1. æ‰“å¼€ `packages/tsdaodaobase/src/Pages/Chat/index.tsx`
2. æ‰¾åˆ°æ˜¾ç¤ºæ–‡å­—çš„åœ°æ–¹
3. ä¿®æ”¹æ–‡å­—
4. ä¿å­˜ï¼Œæµè§ˆå™¨è‡ªåŠ¨åˆ·æ–°
5. çœ‹åˆ°æ•ˆæœï¼

**æ­å–œï¼ä½ å·²ç»æˆåŠŸä¿®æ”¹äº†ä»£ç ï¼** ğŸ‰

---

## ğŸ’¡ å­¦ä¹ å»ºè®®

1. **å…ˆè¿è¡Œé¡¹ç›®** - çœ‹åˆ°æ•ˆæœå†å­¦ä»£ç 
2. **ä»å…¥å£å¼€å§‹** - `apps/web/src/index.tsx`
3. **æŒ‰éœ€æ·±å…¥** - éœ€è¦ä»€ä¹ˆåŠŸèƒ½å†çœ‹ä»€ä¹ˆä»£ç 
4. **å¤šåŠ¨æ‰‹** - æ”¹ä»£ç ã€çœ‹æ•ˆæœã€ç†è§£åŸç†

---

## ğŸ“š è¯¦ç»†å­¦ä¹ 

æƒ³æ·±å…¥å­¦ä¹ ï¼ŸæŸ¥çœ‹ `å­¦ä¹ æŒ‡å—.md` æ–‡ä»¶ï¼

---

**è®°ä½ï¼šä¸è¦è¢«å¤æ‚çš„ç›®å½•å“åˆ°ï¼Œæ ¸å¿ƒå°±è¿™å‡ ä¸ªæ–‡ä»¶ï¼** ğŸš€

